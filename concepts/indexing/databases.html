

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Databases &mdash; Getting Started with Xapian 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Getting Started with Xapian 0.1 documentation" href="../../index.html" />
    <link rel="up" title="Indexing concepts" href="index.html" />
    <link rel="next" title="Documents" href="documents.html" />
    <link rel="prev" title="Indexing concepts" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="documents.html" title="Documents"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Indexing concepts"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Getting Started with Xapian 0.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Core concepts</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Indexing concepts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="databases">
<h1>Databases<a class="headerlink" href="#databases" title="Permalink to this headline">Â¶</a></h1>
<p>Pretty much all Xapian operations revolve around a Xapian database.  Before
searches can be performed, details of the documents to be searched need to
be put into a database; the search process then refers to the database to
efficiently determine the best matches for a given query.  The process of
putting documents into the database is usually referred to as <cite>indexing</cite>.</p>
<p>The main information stored in a database is a mapping from each term to a
list of all the documents it occurs in, together with various statistics
about these occurrences.  It may also store the full text, or extracts,
from the documents, so that result summaries can be displayed.  Databases
can also contain additional data for spelling correction and synonym
expansion, and developers can even store arbitrary key-value pairs in part
of the database.</p>
<p>Xapian databases store data in custom formats which allow searches to be
performed extremely quickly; Xapian does not use a relational database as
its datastore.  There are several database backends; the main backend in
the 1.2 release series of Xapian is called the &#8220;Chert&#8221; backend.  This
stores information in the filesystem (under a given path).  If you&#8217;re
familiar with data storage structures, you might be interested to know that
this backend uses a copy-on-write B+-tree structure, but don&#8217;t worry if
that doesn&#8217;t mean anything to you!</p>
<p>Most backend formats (and certainly the main backend format for each
release) will allow updates to be grouped into transactions, and will allow
at least some old versions of the database to be searched while new ones
are being written.  Currently, all the backends only support a single
writer existing at a given time; attempting to open another writer on
the same database will throw <tt class="docutils literal"><span class="pre">DatabaseLockError</span></tt> to indicate that it
wasn&#8217;t possible to acquire a lock.  Multiple concurrent readers are
supported (in addition to the writer).</p>
<p>When a database is opened for reading, a fixed snapshot of the database is
referenced by the reader (essentially <cite>Multi-Version Concurrency Control</cite>).
Updates which are made to the database will not be visible to the reader
unless it calls <tt class="docutils literal"><span class="pre">Xapian::Database::reopen()</span></tt>.</p>
<p>Currently there&#8217;s  Xapian backends have a limitation to their
<cite>multi-version concurrency</cite> implementation - specifically, at most two
versions can exist concurrently.  So reader will be able to access its
snapshot of the database without limitations when only one change has been
made and committed by the writer, but after the writer has made two
changes, readers will receive a <cite>Xapian::DatabaseModifiedError</cite> if they
attempt to access a part of the database which has changed.  In this
situation, the reader can be updated to the latest version using the
<cite>reopen()</cite> method.</p>
<p>With the disk-based Xapian backends, when a database is opened for writing,
a lock is obtained on the database to ensure that no further writers are
opened concurrently.  This lock will be released when the database writer
is closed (or automatically if the writer process dies).</p>
<p>One unusual feature of Xapian&#8217;s locking mechanism (at least on POSIX
operating systems) is that Xapian forks a subprocess to hold the lock,
rather than holding it in the main process.  This is to avoid the lock
being accidentally released due to the slightly unhelpful semantics of
fcntl locks.</p>
<p>There&#8217;s also a &#8220;remote&#8221; database backend which allows the database to be
located on a different machine and accessed via a custom network protocol.</p>
<p>It is possible to perform searches across multiple databases at once, and
Xapian will handle merging the results together appropriately.  This
feature can be combined with remote databases to handle datasets which are
too large for a single machine, by performing searches across multiple
remote databases.</p>
<p>Xapian has also special support for replicating databases to multiple
machines, such that only the parts of the database which have been modified
are copied; this can be useful for redundancy and load-balancing purposes.</p>
<p>Xapian also supports a simple text file format for listing the locations of
a set of databases (either on the local file system, or remote databases).
Such files are called <cite>stub-databases</cite>, and can be used to point to a
database when the physical database location may vary; for example, because
a new database is being built nightly, and is named according to the date
on which it was built.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Indexing concepts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="documents.html"
                        title="next chapter">Documents</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/concepts/indexing/databases.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="documents.html" title="Documents"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Indexing concepts"
             >previous</a> |</li>
        <li><a href="../../index.html">Getting Started with Xapian 0.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Core concepts</a> &raquo;</li>
          <li><a href="index.html" >Indexing concepts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Olly Betts, Richard Boulton, Justin Finkelstein, James Aylett.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>